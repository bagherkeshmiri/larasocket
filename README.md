# ๐ LaraSocket โ ูุจโุณูฺฉุช ุจูู ูุงุฑุงูู

**LaraSocket** ฺฉ ุณุฑูุฑ WebSocket ุจูู ุจุฑุง **Laravel** ุงุณุช ฺฉู ุจุฏูู ูุงุฒ ุจู ูฺ ูพฺฉุฌ ุฎุงุฑุฌ (ูุซู Pusherุ Redis ุง Socket.IO) ุงุฌุฑุง ูโุดูุฏ ู ูุณุชููุงู ุจุง ุณุงุฎุชุงุฑ ูุงุฑุงูู ฺฉูพุงุฑฺู ุงุณุช.

---

## โจ ูฺฺฏโูุง

- ๐งฉ ุงุฌุฑุง ฺฉุงููุงู ูุณุชูู ุจุฏูู ูฺ ูุงุจุณุชฺฏ ุฎุงุฑุฌ
- ๐ ุงุญุฑุงุฒ ููุช ุงุฎุชุงุฑ ุจุง **Sanctum** ุง ุจุฏูู ุชูฺฉู
- โ๏ธ ูุญุฏูุฏุช ูุฑุฎ ุงุฑุณุงู ูพุงู (Rate Limiting) ู ฺฉูุชุฑู ุชุนุฏุงุฏ ฺฉูุงูุชโูุง
- ๐งพ ูพุดุชุจุงู ุงุฒ ุณุณุชู ูุงฺฏ ูุงุฑุงูู (Log Channels)
- ๐ก ูุงุจู ุชูุธู ุงุฒ ุทุฑู ูุงู `config/larasocket.php`
- โก๏ธ ููุงุณุจ ุจุฑุง ูพุฑูฺูโูุง ุฏุงุฎูุ ูพููโูุงุ ุฏุงุดุจูุฑุฏูุง ู ุงุฑุชุจุงุท ุฒูุฏู ุจู ฺฉูุงูุช ู ุณุฑูุฑ

---

## โ๏ธ ูุตุจ ูพฺฉุฌ 

ูพฺฉุฌ ุฑุง ุจู ูพุฑูฺู ูุงุฑุงูู ุฎูุฏ ุงุถุงูู ฺฉูุฏ:

```bash
composer require bagherkeshmiri/larasocket
```

---

## ุณูพุณ ูุงู ุชูุธูุงุช ุฑุง ููุชุดุฑ (publish) ฺฉูุฏ :

ูพฺฉุฌ ุฑุง ุจู ูพุฑูฺู ูุงุฑุงูู ุฎูุฏ ุงุถุงูู ฺฉูุฏ:

```bash
composer require bagherkeshmiri/larasocket
```

---

## ๐งฉ ุชูุธูุงุช :

ุฏุฑ ูุงู .env ููุงุฏุฑ ููุฑุฏ ูุงุฒ ุฑุง ุชูุธู ฺฉูุฏ:

```bash
LARASOCKET_HOST=127.0.0.1
LARASOCKET_CLIENT_PORT=9000
LARASOCKET_SERVER_PORT=9001
LARASOCKET_AUTH_MODE=sanctum
LARASOCKET_MAX_CLIENTS=200
LARASOCKET_RATE_MESSAGES=20
LARASOCKET_RATE_SECONDS=10
LARASOCKET_LOG_CHANNEL=stack
```
| ฺฉูุฏ                       | ุชูุถุญุงุช                                                                |
| -------------------------- | ---------------------------------------------------------------------- |
| `LARASOCKET_HOST`          | ุขุฏุฑุณ ุง IP ุณุฑูุฑ ูุจโุณูฺฉุช (ุจุฑุง ูููโ ุดุจฺฉูโูุง ุงุฒ `0.0.0.0` ุงุณุชูุงุฏู ฺฉูุฏ) |
| `LARASOCKET_CLIENT_PORT`   | ูพูุฑุช ฺฉู ูุฑูุฑฺฏุฑูุง ุจู ุขู ูุตู ูโุดููุฏ (ูุซู `ws://127.0.0.1:9000`)        |
| `LARASOCKET_SERVER_PORT`   | ูพูุฑุช ุฏุงุฎู ุจุฑุง ุงุฑุณุงู ูพุงู ุงุฒ ุทุฑู ูุงุฑุงูู (ููุท ูุญู ู ุงูู ุจุงุดุฏ)        |
| `LARASOCKET_AUTH_MODE`     | ุญุงูุช ุงุญุฑุงุฒ ููุช (`none` ุง `sanctum`)                                  |
| `LARASOCKET_MAX_CLIENTS`   | ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู ูุชุตู ููโุฒูุงู                                      |
| `LARASOCKET_RATE_MESSAGES` | ุชุนุฏุงุฏ ูพุงู ูุฌุงุฒ ูุฑ ฺฉูุงูุช                                              |
| `LARASOCKET_RATE_SECONDS`  | ุจุงุฒู ุฒูุงู ุจุฑุง ูุญุฏูุฏุณุงุฒ ูพุงูโูุง                                      |
| `LARASOCKET_LOG_CHANNEL`   | ฺฉุงูุงู ูุงฺฏ ูุงุฑุงูู (ูุซูุงู `single` ุง `stack`)                           |

---

## ๐ ุญุงูุชโูุง ุงุญุฑุงุฒ ููุช :

LaraSocket ุงุฒ ุฏู ุญุงูุช ุณุงุฏู ูพุดุชุจุงู ูโฺฉูุฏ:

| ุญุงูุช      | ุชูุถุญุงุช                                 |
| --------- | --------------------------------------- |
| `none`    | ุจุฏูู ูุงุฒ ุจู ุชูฺฉู (ุงุชุตุงู ุขุฒุงุฏ)          |
| `sanctum` | ุงุชุตุงู ููุท ุจุง ุชูฺฉู ูุนุชุจุฑ Laravel Sanctum |

---

## ๐ง ุณุงุฎุช ฺฉูุงุณ ุงุนุชุจุงุฑุณูุฌ ุชูฺฉู (Sanctum) :

ููุทู ุจุฑุฑุณ ุชูฺฉู ุฏุฑ ูพุฑูฺู ุดูุง ูุฑุงุฑ ุฏุงุฑุฏุ ูู ุฏุฑ ูพฺฉุฌ.
ุฏุฑ ูุณุฑ ุฒุฑ ุฏุฑ ูพุฑูฺูโ ูุงุฑุงูู ุฎูุฏ ฺฉ ูุงู ุจุณุงุฒุฏ:

```bash
<?php

namespace App\Support;

use Laravel\Sanctum\PersonalAccessToken;
use Illuminate\Support\Facades\Log;

class LaraSocketValidator
{
    public static function check(?string $token): bool
    {
        $mode = config('larasocket.auth_mode');

        // ุญุงูุช ุนููู (ุจุฏูู ุงุญุฑุงุฒ)
        if ($mode === 'none') {
            return true;
        }

        // ุญุงูุช Sanctum
        if ($mode === 'sanctum') {
            if (empty($token)) return false;

            try {
                $accessToken = PersonalAccessToken::findToken($token);
                return $accessToken?->tokenable !== null;
            } catch (\Throwable $e) {
                Log::error('LaraSocket Sanctum token validation failed: ' . $e->getMessage());
                return false;
            }
        }

        return false;
    }
}

```

---

## ๐ ุงุฌุฑุง ุณุฑูุฑ WebSocket :

ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ:

```bash
php artisan larasocket:serve
```

ุจุฑุง ูุดุฎุต ฺฉุฑุฏู host ุง port ุฏูุฎูุงู:

```bash
php artisan larasocket:serve --host=0.0.0.0 --port=9000
```

ุฏุฑ ุตูุฑุช ููููุชุ ูพุบุงู ูุดุงุจู ุฒุฑ ุฑุง ูโุจูุฏ:

```bash
๐ Starting LaraSocket WebSocket server on ws://127.0.0.1:9000
Press Ctrl+C to stop the server
```

---

## ๐ ููููู ุงุชุตุงู ุงุฒ ุณูุช ูุฑูุฑฺฏุฑ :

ุงฺฏุฑ ุงุญุฑุงุฒ ููุช ุบุฑูุนุงู ุจุงุดุฏ (LARASOCKET_AUTH_MODE=none):

```bash
const ws = new WebSocket("ws://127.0.0.1:9000");

ws.onopen = () => console.log("ุงุชุตุงู ุจุฑูุฑุงุฑ ุดุฏ");
ws.onmessage = e => console.log("ูพุงู ุฏุฑุงูุช:", e.data);
```

ุงฺฏุฑ ุงุญุฑุงุฒ ููุช ูุนุงู ุจุงุดุฏ (LARASOCKET_AUTH_MODE=sanctum):

```bash
const token = "ุชูฺฉู_sanctum_ฺฉุงุฑุจุฑ";
const ws = new WebSocket(`ws://127.0.0.1:9000/?token=${token}`);

ws.onopen = () => console.log("ุงุชุตุงู ุงุญุฑุงุฒ ุดุฏู ุจุง Sanctum");
ws.onmessage = e => console.log("ูพุงู:", e.data);
```

---

## ๐ก ุงุฑุณุงู ูพุงู ุงุฒ ุณูุช ูุงุฑุงูู :

ูโุชูุงูุฏ ุงุฒ ูุฑ ฺฉูุชุฑูุฑ ุง Job ุจุฑุง ุงุฑุณุงู ูพุงู ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
Route::get('/broadcast', function () {
    $message = json_encode([
        'event' => 'ping',
        'data' => 'ุณูุงู ุงุฒ ูุงุฑุงูู!'
    ]);

    $socket = stream_socket_client('tcp://127.0.0.1:9001');
    fwrite($socket, $message);
    fclose($socket);

    return 'ูพุงู ุงุฑุณุงู ุดุฏ!';
});
```

---

## ๐งฐ ูฺฉุงุช ูู ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู :

ูโุชูุงูุฏ ุงุฒ ูุฑ ฺฉูุชุฑูุฑ ุง Job ุจุฑุง ุงุฑุณุงู ูพุงู ุงุณุชูุงุฏู ฺฉูุฏ:

*   ุณุฑูุฑ ุจุฏูู ุญุงูุช (stateless) ุงุณุช ู ูุฑ ูพุงู ุจูโุตูุฑุช ูุณุชูู ูพุฑุฏุงุฒุด ูโุดูุฏ.
*  ุฑุง ุงุณุชูุงุฏู ุฏุฑ ูุญุท ุชููุฏ (Production)ุ ูพุดููุงุฏ ูโุดูุฏ ูพุดุช Nginx ุง Caddy ุจุฑุง ูพุดุชุจุงู ุงุฒ wss:// ูุฑุงุฑ ฺฏุฑุฏ.
*   ูพูุฑุช ุฏุงุฎู (server_port) ููุท ุจุงุฏ ุฏุฑ ุฏุณุชุฑุณ ุฎูุฏ ูุงุฑุงูู ุจุงุดุฏ.
*   ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ุนููฺฉุฑุฏ ุจุงูุงุ ูโุชูุงู ฺูุฏ ุณุฑูุฑ ูุจโุณูฺฉุช ุฑุง ุจูโุตูุฑุช ุฌุฏุงฺฏุงูู ุงุฌุฑุง ฺฉุฑุฏ.

---

## ๐งญ ููุดู ุฑุงู (Roadmap) :

ูโุชูุงูุฏ ุงุฒ ูุฑ ฺฉูุชุฑูุฑ ุง Job ุจุฑุง ุงุฑุณุงู ูพุงู ุงุณุชูุงุฏู ฺฉูุฏ:

*  ูพุดุชุจุงู ุงุฒ ุงุญุฑุงุฒ JWT
*  ูพุดุชุจุงู ุงุฒ Room ู ฺฉุงูุงูโูุง ูุฌุฒุง
*  ูพุดุชุจุงู ุงุฒ SSL/TLS ุฏุงุฎู

---

## ๐จโ๐ป ุชูุณุนู ุฏููุฏู :

ุจุงูุฑ ฺฉุดูุฑ

๐ง bagherkeshmiri@gmail.com

๐ GitHub: @bagherkeshmiri

---

## ๐ ูุฌูุฒ :

ุงู ูพฺฉุฌ ุชุญุช ูุงุณูุณ MIT ููุชุดุฑ ุดุฏู ุงุณุช ู ุงุณุชูุงุฏูุ ุชุบุฑ ู ุงูุชุดุงุฑ ุขู ุขุฒุงุฏ ุงุณุช.

---


